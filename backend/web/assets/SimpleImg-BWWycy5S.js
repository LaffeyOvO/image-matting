import{q as Re,x as Ae,r as u,y as r,o as ae,z as Be,A as J,g as s,a as h,c as w,B as c,b as i,t as D,C as ce,D as Ee,u as Pe,E as Me,G as De,f as He,m as te,p as We,d as Oe}from"./index-CDkhBg84.js";import{a as Te}from"./ai_matting-S4SumhKP.js";import{m as M}from"./message-DMU8knBd.js";import{_ as ze}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ne=["innerHTML"],Ve=["id"],Fe=["alt","src"],Xe=["alt","src"],Ye=["innerHTML"],je=Re({__name:"VueCompareImage",props:{aspectRatio:{default:"wider"},handle:{type:[String,Number,Boolean]},handleSize:{default:40},hover:{type:Boolean,default:!1},slideOnClick:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!1},keyboardStep:{default:.01},leftImage:{},leftImageAlt:{},leftImageCss:{},leftImageLabel:{},onSliderPositionChange:{type:Function,default:()=>{}},rightImage:{},rightImageAlt:{},rightImageCss:{},rightImageLabel:{},skeleton:{type:[String,Number,Boolean]},sliderLineColor:{default:"#ffffff"},sliderLineWidth:{default:2},sliderPositionPercentage:{default:.5},vertical:{type:Boolean,default:!1}},emits:["slideStart","slideEnd","isSliding"],setup(C,{emit:m}){const y=C,L=m,{aspectRatio:x,leftImage:H,leftImageAlt:W,leftImageLabel:I,leftImageCss:U,rightImage:Q,rightImageAlt:Z,rightImageLabel:O,rightImageCss:ee,hover:T,handle:q,handleSize:a,sliderLineWidth:n,sliderPositionPercentage:k,skeleton:z,sliderLineColor:$,vertical:R,onSliderPositionChange:A,slideOnClick:G,keyboard:N,keyboardStep:d}=Ae(y),de=Math.random().toString(36).substr(2,9),l=!R.value,b=u(),B=u(null),V=u(null),o=u(k.value),f=u(0),g=u(0),F=u(!1),X=u(!1),E=u(!1),le=r(()=>F.value&&X.value),K=r(()=>o.value),oe=r(()=>1-o.value),ne=r(()=>({display:le.value?"flex":"none",height:`${g.value}px`})),fe=r(()=>({clipPath:l?`inset(0px 0px 0px ${f.value*K.value}px)`:`inset(${g.value*K.value}px 0px 0px 0px)`,...ee})),me=r(()=>({clipPath:l?`inset(0px ${f.value*oe.value}px 0px 0px)`:`inset(0px 0px ${g.value*oe.value}px 0px)`,...U})),ge=r(()=>({cursor:!T.value&&l?"ew-resize !important":!T.value&&!l?"ns-resize !important":void 0,flexDirection:l?"column":"row",height:l?"100%":`${a.value}px`,left:l?`${f.value*o.value-a.value/2}px`:"0",top:l?"0":`${g.value*o.value-a.value/2}px`,width:l?`${a.value}px`:"100%"})),se=r(()=>({background:$.value,height:l?"100%":`${n.value}px`,width:l?`${n.value}px`:"100%"})),pe=r(()=>({border:`${n.value}px solid ${$.value}`,height:`${a.value}px`,width:`${a.value}px`,transform:l?"none":"rotate(90deg)"})),he=r(()=>({border:`inset ${a.value*.15}px rgba(0,0,0,0)`,borderRight:`${a.value*.15}px solid ${$.value}`,marginLeft:`-${a.value*.25}px`,marginRight:`${a.value*.25}px`})),we=r(()=>({border:`inset ${a.value*.15}px rgba(0,0,0,0)`,borderLeft:`${a.value*.15}px solid ${$.value}`,marginRight:`-${a.value*.25}px`})),ye=r(()=>({left:l?"5%":"50%",opacity:E.value?0:1,top:l?"50%":"3%",transform:l?"translate(0,-50%)":"translate(-50%, 0)"})),xe=r(()=>({opacity:E.value?0:1,left:l?"unset":"50%",right:l?"5%":"unset",top:l?"50%":"unset",bottom:l?"unset":"3%",transform:l?"translate(0,-50%)":"translate(-50%, 0)"})),be=r(()=>({clip:l?`rect(auto, ${f.value*o.value}px, auto, auto)`:`rect(auto, auto, ${g.value*o.value}px, auto)`})),_e=r(()=>({clipPath:l?`inset(0px 0px 0px ${f.value*K.value}px)`:`inset(${g.value*K.value}px 0px 0px 0px)`}));function S(e){const t=e,p=t.touches?t.touches[0].pageX:t.pageX,j=t.touches?t.touches[0].pageY:t.pageY,Se=p-window.pageXOffset,Ce=j-window.pageYOffset,re=B.value.getBoundingClientRect();let _=l?Se-re.left:Ce-re.top;const ue=0+n.value/2,ve=l?f.value-n.value/2:g.value-n.value/2;_<ue&&(_=ue),_>ve&&(_=ve),o.value=l?_/f.value:_/g.value,A.value&&A.value(l?_/f.value:_/g.value)}function P(e){E.value=!0,L("slideStart",o.value),L("isSliding",E.value),l&&"touches"in e||e.preventDefault(),G.value&&S(e),window.addEventListener("mousemove",S),window.addEventListener("touchmove",S),window.addEventListener("mouseup",v),window.addEventListener("touchend",v)}function v(){E.value=!1,L("slideEnd",o.value),L("isSliding",E.value),window.removeEventListener("mousemove",S),window.removeEventListener("touchmove",S),window.removeEventListener("mouseup",v),window.removeEventListener("touchend",v)}function Le(){N.value&&window.addEventListener("keydown",Y)}function Ie(){N.value&&window.removeEventListener("keydown",Y)}function ke(){N.value&&window.addEventListener("keydown",Y)}function ie(e){b.value&&!b.value.contains(e.target)&&(b.value.blur(),window.removeEventListener("keydown",Y))}function Y(e){e.key==="ArrowDown"&&!l?(e.preventDefault(),o.value+d.value>1?o.value=1:o.value+=d.value):e.key==="ArrowUp"&&!l||e.key==="ArrowLeft"&&l?(e.preventDefault(),o.value-d.value<0?o.value=0:o.value-=d.value):e.key==="ArrowRight"&&l&&(e.preventDefault(),o.value+d.value>1?o.value=1:o.value+=d.value)}function $e(){var p;const e=Ee();(p=e==null?void 0:e.proxy)==null||p.$forceUpdate();const t=b.value;y.hover?(t==null||t.addEventListener("mousemove",P),t==null||t.addEventListener("mouseleave",v)):(t==null||t.removeEventListener("mousemove",P),t==null||t.removeEventListener("mouseleave",v),t==null||t.addEventListener("mouseup",v),t==null||t.addEventListener("touchend",v))}return ae(()=>{const e=b.value,t=new ResizeObserver(([p])=>{const j=p.target.getBoundingClientRect().width;f.value=j});return t.observe(e),()=>t.disconnect()}),ae(()=>{const e=b.value;y.hover&&(e==null||e.addEventListener("mousemove",P),e==null||e.addEventListener("mouseleave",v)),window.addEventListener("click",ie)}),Be(()=>{const e=b.value;e==null||e.removeEventListener("mousemove",P),e==null||e.removeEventListener("mouseleave",v),window.removeEventListener("keydown",Y),window.removeEventListener("click",ie),window.removeEventListener("mousemove",S),window.removeEventListener("touchmove",S),window.removeEventListener("mouseup",v),window.removeEventListener("touchend",v)}),J(V,()=>{var e;F.value=!1,(e=V.value)!=null&&e.complete&&(F.value=!0)}),J(B,()=>{var e;X.value=!1,(e=B.value)!=null&&e.complete&&(X.value=!0)}),J(T,()=>{$e()}),J([()=>f.value,()=>F.value,()=>X.value],()=>{const e=V.value.naturalHeight/V.value.naturalWidth,t=B.value.naturalHeight/B.value.naturalWidth,p=x.value==="taller"?Math.max(e,t):Math.min(e,t),j=f.value*p;g.value=j}),(e,t)=>s(z)&&!le.value?(h(),w("div",{key:0,"data-testid":"skeleton",style:c(ne.value),innerHTML:s(z)},null,12,Ne)):(h(),w("div",{key:1,id:s(de),ref_key:"containerRef",ref:b,class:"vci--container",tabindex:"0","data-testid":"vci-container",style:c(ne.value),onClick:ke,onTouchstart:P,onTouchend:v,onFocusin:Le,onFocusout:Ie,onMousedown:P,onMouseup:v},[i("img",{ref_key:"rightImageRef",ref:B,class:"vci--right-image",alt:s(Z),"data-testid":"right-image",src:s(Q),style:c(fe.value),onLoad:t[0]||(t[0]=p=>X.value=!0)},null,44,Fe),i("img",{ref_key:"leftImageRef",ref:V,class:"vci--left-image",alt:s(W),"data-testid":"left-image",src:s(H),style:c(me.value),onLoad:t[1]||(t[1]=p=>F.value=!0)},null,44,Xe),i("div",{class:"vci--slider",style:c(ge.value)},[i("div",{class:"vci--slider-line",style:c(se.value)},null,4),s(q)?(h(),w("div",{key:0,class:"vci--custom-handle",innerHTML:s(q)},null,8,Ye)):(h(),w("div",{key:1,class:"vci--default-handle",style:c(pe.value)},[i("div",{class:"vci--left-arrow",style:c(he.value)},null,4),i("div",{class:"vci--right-arrow",style:c(we.value)},null,4)],4)),i("div",{class:"vci--slider-line",style:c(se.value)},null,4)],4),s(I)?(h(),w("div",{key:0,class:"vci--left-label-container",style:c(be.value)},[i("div",{class:"vci--left-label","data-testid":"left-image-label",style:c(ye.value)},D(s(I)),5)],4)):ce("",!0),s(O)?(h(),w("div",{key:1,class:"vci--right-label-container",style:c(_e.value)},[i("div",{class:"vci--right-label","data-testid":"right-image-label",style:c(xe.value)},D(s(O)),5)],4)):ce("",!0)],44,Ve))}}),Ue=C=>(We("data-v-0b75895a"),C=C(),Oe(),C),qe={class:"relative overflow-x-auto mx-auto h-full flex flex-col items-center justify-center"},Ge={key:0,class:"w-full max-w-3xl p-4"},Ke={class:"flex items-center justify-center h-full"},Je={class:"flex justify-center space-x-4 mt-4"},Qe={key:1,class:"flex justify-center items-center h-full"},Ze=Ue(()=>i("div",{class:"loader"},null,-1)),et=[Ze],tt={__name:"SimpleImg",setup(C){const{t:m}=Pe(),y=u(!0),L=Me(),x=u("");x.value=L.params.filePath;const H=u("");H.value=L.params.imgType;const W=u(""),I=u("");async function U(){if(H.value==="local"){const a=await te("get_local_file_base64",x.value);console.log(a),a.code===200?W.value=a.data.base64_image:M.error(a.error_msg)}else W.value=x.value}u({});const Q=()=>{window.history.back()},Z=async()=>{const a=await te("open_file_dialog",!1);y.value=!0,H.value="local",a.data.file_path&&(x.value=a.data.file_path,console.log(x.value),await U(),await O()),y.value=!1};async function O(){const a=await Te("predict",x.value);a.code===200?I.value=a.data.no_bg_image:M.error(a.error_msg),y.value=!1}function ee(a){const n=a.split(";base64,"),k=n[0].split(":")[1],z=atob(n[1]),$=[];for(let R=0;R<z.length;R+=1024){const A=z.slice(R,R+1024),G=new Array(A.length);for(let d=0;d<A.length;d++)G[d]=A.charCodeAt(d);const N=new Uint8Array(G);$.push(N)}return new Blob($,{type:k})}async function T(){try{const a=ee(I.value),n=new ClipboardItem({"image/png":a});await navigator.clipboard.write([n]),M.info(m("common.copy_success"))}catch(a){M.error(m("common.copy_error"),a)}}async function q(){(await te("save_png_dialog",I.value)).code===200?M.info(m("common.download_success")):M.error(m("common.download_error"))}return De(async()=>{await U()}),ae(async()=>{await O()}),(a,n)=>(h(),w("div",qe,[y.value?(h(),w("div",Qe,et)):(h(),w("div",Ge,[i("div",Ke,[He(s(je),{"left-image":W.value,"right-image":I.value,class:"img-container img-transparent-bg"},null,8,["left-image","right-image"])]),i("div",Je,[i("button",{onClick:n[0]||(n[0]=k=>Q()),class:"bg-green-500 text-white px-4 py-2 rounded-full"},D(s(m)("common.btn_back")),1),i("button",{onClick:n[1]||(n[1]=k=>Z()),class:"bg-green-500 text-white px-4 py-2 rounded-full"},D(s(m)("common.btn_reselect")),1),i("button",{onClick:n[2]||(n[2]=k=>T()),class:"bg-green-500 text-white px-4 py-2 rounded-full"},D(s(m)("common.btn_copy")),1),i("button",{onClick:n[3]||(n[3]=k=>q()),class:"bg-green-500 text-white px-4 py-2 rounded-full"},D(s(m)("common.btn_download")),1)])]))]))}},st=ze(tt,[["__scopeId","data-v-0b75895a"]]);export{st as default};
