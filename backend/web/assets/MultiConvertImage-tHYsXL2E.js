import{u as S,r as u,A as j,k as G,a as l,c as n,b as o,t as i,g as h,h as N,I as A,F as k,l as y,C as f,m as b,p as $,d as D}from"./index-CDkhBg84.js";import{m as w}from"./message-DMU8knBd.js";import{c as C}from"./convert_image-TBWoQEUR.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";const d=_=>($("data-v-6a324d9b"),_=_(),D(),_),T={class:"mx-auto"},V={class:"flex justify-center space-x-10 mt-4"},z=["value"],U=["disabled"],J={class:"mt-4 flex justify-center items-center"},O={class:"space-y-2 max-h-96 max-w-3xl overflow-y-auto"},W={class:"grow ml-4 flex flex-col truncate"},q=["title"],H=["title"],K={class:"flex-none btn btn-circle btn-ghost ml-4"},Q=["onClick"],R=d(()=>o("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",class:"opacity-25"},null,-1)),X=d(()=>o("path",{fill:"currentColor",d:"M4 12a8 8 0 017.5-7.98A4 4 0 104 12h4z",class:"opacity-75"},null,-1)),Y=[R,X],Z=["onClick"],ee=d(()=>o("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)),te=[ee],se=["onClick"],oe=d(()=>o("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,-1)),ae=[oe],le={key:0,class:"mt-6 text-center"},ne={key:1,class:"flex justify-center items-center"},re=d(()=>o("div",{class:"loader"},null,-1)),ce=[re],ie={__name:"MultiConvertImage",setup(_){const{t:m}=S(),p=u(!1),I=["PNG","JPEG","GIF","BMP","WEBP","ICO","ICNS","TIFF","PDF"],v=u("PNG"),r=u(null),c=u(!1),a=u([]),F=async()=>{const e=await b("open_folder_dialog","");e.code===200?r.value=e.data.folder_path:w.error(e.error_msg)},B=()=>{c.value=!1;for(let e=0;e<a.value.length;e++){const s=a.value[e];s.status==="waiting"&&(s.status="")}},P=async()=>{p.value=!0;const e=await C("get_folder_convert_images",r.value);console.log("getConvertFileList",e),e.code===200?a.value=e.data.convert_images:w.error(e.error_msg),p.value=!1};j(r,async()=>{r.value&&await P()});const g=async e=>{await b("open_and_select_file",e)},L=async()=>{if(!c.value){c.value=!0,console.log("start deal image");for(let e=0;e<a.value.length;e++){const s=a.value[e];s.status===""&&(s.status="waiting")}for(let e=0;e<a.value.length;e++){const s=a.value[e];if(c.value===!0){if(s.status==="waiting"){console.log("deal image",s.image_path,r.value);const t=await C("convert_image_from_folder",{image_path:s.image_path,folder_path:r.value,output_format:v.value});t.code===200?(s.status="processed",s.convert_result=t.data.convert_result):(s.status="error",w.error(t.error_msg))}}else break}c.value=!1}};return G(()=>{c.value=!1,a.value=[],r.value=null}),(e,s)=>(l(),n("div",T,[o("div",V,[o("button",{class:"bg-green-500 btn text-white px-4 py-2 rounded-full btn-md",onClick:F},i(h(m)("convert.mult_convert_image.select_folder_btn")),1),N(o("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>v.value=t),class:"select select-bordered w-32 px-4"},[(l(),n(k,null,y(I,t=>o("option",{value:t},i(t),9,z)),64))],512),[[A,v.value]]),o("button",{disabled:!v.value||!r.value,onClick:L,class:"bg-green-500 btn text-white px-4 py-2 rounded-full btn-md"},i(h(m)("convert.mult_convert_image.start_convert_btn")),9,U)]),o("div",J,[o("ul",O,[(l(!0),n(k,null,y(a.value,(t,M)=>(l(),n("li",{key:M,class:"flex p-2 rounded-lg"},[o("div",W,[o("p",{class:"truncate",title:t.image_name},i(t.image_name),9,q),o("p",{class:"text-xs text-gray-400 truncate",title:t.image_path},i(t.image_path),9,H)]),o("span",K,[t.status==="waiting"?(l(),n("svg",{key:0,onClick:x=>g(t.image_path),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"w-6 h-6 animate-spin"},Y,8,Q)):t.status==="processed"?(l(),n("svg",{key:1,onClick:x=>g(t.convert_result),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"w-6 h-6 text-green-500"},te,8,Z)):t.status==="error"?(l(),n("svg",{key:2,onClick:x=>g(t.image_path),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"w-6 h-6 text-red-500"},ae,8,se)):f("",!0)])]))),128))])]),c.value?(l(),n("div",le,[o("button",{onClick:s[1]||(s[1]=t=>B()),class:"bg-green-500 text-white px-4 py-2 rounded-full"},i(h(m)("convert.mult_convert_image.finish")),1)])):f("",!0),p.value?(l(),n("div",ne,ce)):f("",!0)]))}},me=E(ie,[["__scopeId","data-v-6a324d9b"]]);export{me as default};
