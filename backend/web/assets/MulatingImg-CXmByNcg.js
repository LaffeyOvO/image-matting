import{u as P,E as j,r as d,y as L,o as $,k as F,a,c as n,b as t,t as i,g,F as A,l as z,C as f,m as v}from"./index-CDkhBg84.js";import{a as w}from"./ai_matting-S4SumhKP.js";import{m as k}from"./message-DMU8knBd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const D={class:"flex justify-center w-full h-full items-center"},E={class:"w-3/4 max-w-2xl rounded-lg p-6"},N={class:"flex justify-between items-center mb-4"},V={class:"text-lg font-bold"},R={class:"badge badge-info"},S={class:"space-y-2 max-h-96 w-full overflow-y-auto"},T=["src"],U={class:"grow ml-4 flex flex-col truncate"},q=["title"],G=["title"],H={class:"flex-none btn btn-circle btn-ghost ml-4"},J=["onClick"],K=t("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",class:"opacity-25"},null,-1),O=t("path",{fill:"currentColor",d:"M4 12a8 8 0 017.5-7.98A4 4 0 104 12h4z",class:"opacity-75"},null,-1),Q=[K,O],W=["onClick"],X=t("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1),Y=[X],Z=["onClick"],ee=t("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,-1),te=[ee],se={key:0,class:"mt-6 text-center"},oe={key:1,class:"mt-6 text-center"},ae={key:2,class:"flex justify-center items-center mt-4"},ne=t("div",{class:"loader"},null,-1),le=[ne],de={__name:"MulatingImg",setup(ie){const{t:c}=P(),x=j(),r=d(""),l=d([]),_=d(!0),u=d(!0),y=L(()=>l.value.filter(s=>s.status==="processed").length),b=async()=>{for(let s=0;s<l.value.length;s++){const o=l.value[s],e=await v("get_local_file_base64",o.image_path);console.log(e,"base64"),e.code===200&&(o.base64_image=e.data.base64_image)}},C=async()=>{console.log("start deal image");for(let s=0;s<l.value.length;s++){const o=l.value[s];if(u.value===!0){if(o.status==="waiting"){console.log("deal image",o.image_path,r.value);const e=await w("predict_from_folder_img",{image_path:o.image_path,folder_path:r.value});e.code===200?(o.status="processed",o.no_bg_image=e.data.no_bg_image):(o.status="error",k.error(e.error_msg))}}else return}u.value=!1},h=()=>{u.value=!1},B=async()=>{_.value=!0;const s=await w("get_folder_images",r.value);s.code===200?l.value=s.data.image_list:k.error(s.error_msg),_.value=!1},I=()=>{window.history.back()},m=async s=>{await v("open_and_select_file",s)};return $(async()=>{r.value=x.params.folderPath,console.log(r.value,"foldersPath"),await B(),await Promise.all([b(),C()])}),F(()=>{console.log("unmounted"),h()}),(s,o)=>(a(),n("div",D,[t("div",E,[t("div",N,[t("h2",V,i(g(c)("ai_matting.mult_matting.title")),1),t("span",R,i(g(c)("ai_matting.mult_matting.processing"))+" "+i(y.value)+" / "+i(l.value.length),1)]),t("ul",S,[(a(!0),n(A,null,z(l.value,(e,M)=>(a(),n("li",{key:M,class:"flex p-2 rounded-lg"},[t("img",{src:e.base64_image,alt:"image",class:"w-16 h-16 rounded flex-none"},null,8,T),t("div",U,[t("p",{class:"truncate",title:e.image_name},i(e.image_name),9,q),t("p",{class:"text-xs text-gray-400 truncate",title:e.image_path},i(e.image_path),9,G)]),t("span",H,[e.status==="waiting"?(a(),n("svg",{key:0,onClick:p=>m(e.image_path),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"w-6 h-6 animate-spin"},Q,8,J)):e.status==="processed"?(a(),n("svg",{key:1,onClick:p=>m(e.no_bg_image),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"w-6 h-6 text-green-500"},Y,8,W)):e.status==="error"?(a(),n("svg",{key:2,onClick:p=>m(e.image_path),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"w-6 h-6 text-red-500"},te,8,Z)):f("",!0)])]))),128))]),u.value&&!_.value?(a(),n("div",se,[t("button",{onClick:o[0]||(o[0]=e=>h()),class:"bg-green-500 text-white px-4 py-2 rounded-full"},i(g(c)("ai_matting.mult_matting.finish")),1)])):(a(),n("div",oe,[t("button",{onClick:o[1]||(o[1]=e=>I()),class:"bg-green-500 text-white px-4 py-2 rounded-full"},i(g(c)("common.btn_back")),1)])),_.value?(a(),n("div",ae,le)):f("",!0)])]))}};export{de as default};
